---
import ImageMod from "@/components/ImageMod.astro";
import config from "@/config/config.json";
import { markdownify } from "@/lib/utils/textConverter";
import { getEntry } from "astro:content";

const pageIndex = await getEntry("homepage", "-index");
if (!pageIndex) return null;

const { title, subtitle, images, freeTrial, footnotes } = pageIndex.data.banner;
const { free_trial_form_action } = config.params;
---

<section class="ph-spacing pt-[7rem] pb-[5rem] lg:pb-[12rem] overflow-x-hidden">
  <div class="container">
    <div class="flex flex-col lg:flex-row lg:items-center max-lg:gap-10">
      <div class="lg:w-[56%] lg:pr-5 xl:pr-20">
        <h1
          data-aos="fade-up-sm"
          data-aos-delay="0"
          class="hero-heading hasEmphasize mb-10"
          set:html={markdownify(title)}
        />
        <p
          data-aos="fade-up-sm"
          data-aos-delay="50"
          class="text-h5-sm leading-relaxed"
          set:html={markdownify(subtitle)}
        />

        {
          freeTrial.enable && (
            <form
              data-aos="fade-up-sm"
              data-aos-delay="100"
              action="https://formsubmit.co/enmamosley@gmail.com"
              method="POST"
              data-astro-reload
              class="mt-12 flex flex-col sm:flex-row items-stretch gap-3 w-full"
            >
              {/* FormSubmit Configuration */}
              <input type="hidden" name="_subject" value="Nueva consulta desde Ticmans - Banner Principal" />
              <input type="hidden" name="_template" value="table" />
              <input type="hidden" name="_captcha" value="false" />
              <input type="hidden" name="_next" value="https://ticmans.com/gracias" />
              <input type="hidden" name="origen" value="Banner Principal" />
              
              <input
                type="email"
                name="email"
                id="email"
                placeholder={freeTrial.placeholder}
                required
                class="bg-light self-stretch h-16 xl:h-[4.3rem] rounded-lg border-none w-full sm:max-w-[370px] px-6 placeholder:text-lg"
              />
              <button
                type="submit"
                class="btn btn-primary min-w-max !rounded-lg text-lg"
              >
                {freeTrial.title}
              </button>
            </form>
          )
        }
        {
          footnotes.enable && (
            <p
              data-aos="fade-up-sm"
              data-aos-delay="200"
              class="mt-4 [&>a]:text-primary [&>a]:font-medium [&>a]:ml-1 font-text-light"
              set:html={markdownify(footnotes.title)}
            />
          )
        }
      </div>
      <div class="lg:w-[44%]">
        <div class="relative size-full">
          <ImageMod
            src={images.bannerImage}
            alt={images.bannerImageAlt}
            width={1107}
            height={738}
            quality="max"
            class="rounded-[1rem] max-w-max opacity-100 lg:opacity-0 max-lg:size-full max-lg:p-5 max-lg:bg-primary/20"
          />
          <div
            class="hidden lg:block absolute inset-0 w-[200%] h-full bg-secondary/20 rounded-[2rem] z-0"
            aria-hidden="true"
          >
          </div>
          <div class="hidden lg:block absolute left-10 top-10 z-10">
            <div data-aos="fade-up-sm" data-aos-delay="100">
              <ImageMod
                src={images.bannerImage}
                alt={images.bannerImageAlt}
                width={1107}
                height={738}
                quality="max"
                class="rounded-[1rem] max-w-max shadow-2xl"
              />
            </div>
            <!-- Floating Images -->
            {images.floatingImages && images.floatingImages.length > 0 && (
              <>
                <div
                  aria-hidden="true"
                  class="absolute top-0 left-1/3 xl:left-1/2 z-20"
                >
                  <div data-aos="zoom-out-sm" data-aos-delay="400">
                    <div
                      class="inline-block p-1 bg-white rounded-full shadow-2xl -translate-y-1/2"
                    >
                      <ImageMod
                        src={images.floatingImages[0].image}
                        alt={images.bannerImageAlt}
                        width={120}
                        height={120}
                        quality="max"
                        class="rounded-full w-20 aspect-square object-cover bg-secondary/60 backdrop-blur-lg"
                      />
                    </div>
                  </div>
                </div>
                {images.floatingImages.length > 1 && (
                  <div aria-hidden="true" class="absolute bottom-1/4 left-0 z-20">
                    <div data-aos="zoom-out-sm" data-aos-delay="550">
                      <div
                        class="inline-block p-1 bg-white rounded-full shadow-2xl -translate-x-1/2"
                      >
                        <ImageMod
                          src={images.floatingImages[1].image}
                          alt={images.bannerImageAlt}
                          width={120}
                          height={120}
                          quality="max"
                          class="rounded-full w-20 aspect-square object-cover bg-primary/60 backdrop-blur-lg"
                        />
                      </div>
                    </div>
                  </div>
                )}
              </>
            )}
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
